{"ast":null,"code":"import _regeneratorRuntime from\"/home/runner/work/watchparty/watchparty/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/runner/work/watchparty/watchparty/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/home/runner/work/watchparty/watchparty/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/runner/work/watchparty/watchparty/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/runner/work/watchparty/watchparty/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/runner/work/watchparty/watchparty/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import{Modal,Button,Table,Message,Dropdown}from'semantic-ui-react';import{GoogleReCaptchaProvider,withGoogleReCaptcha}from'react-google-recaptcha-v3';import{SignInButton}from'../TopBar/TopBar';import{serverPath}from'../../utils';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var VBrowserModal=/*#__PURE__*/function(_React$Component){_inherits(VBrowserModal,_React$Component);var _super=_createSuper(VBrowserModal);function VBrowserModal(){var _this;_classCallCheck(this,VBrowserModal);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={isVMPoolFull:false,region:'US',regionPlus:'US'};return _this;}_createClass(VBrowserModal,[{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _metadata$isVMPoolFul;var resp,metadata;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return window.fetch(serverPath+'/metadata');case 2:resp=_context.sent;_context.next=5;return resp.json();case 5:metadata=_context.sent;// TODO make this check on region change\nif((_metadata$isVMPoolFul=metadata.isVMPoolFull)===null||_metadata$isVMPoolFul===void 0?void 0:_metadata$isVMPoolFul.HetznerUS){this.setState({isVMPoolFull:true});}case 7:case\"end\":return _context.stop();}}},_callee,this);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"render\",value:function render(){var _this2=this;var _this$props=this.props,closeModal=_this$props.closeModal,startVBrowser=_this$props.startVBrowser;var LaunchButton=withGoogleReCaptcha(function(_ref){var googleReCaptchaProps=_ref.googleReCaptchaProps,large=_ref.large;return/*#__PURE__*/_jsx(Button,{size:\"large\",color:large?'orange':undefined,onClick:/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var rcToken;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return googleReCaptchaProps.executeRecaptcha('launchVBrowser');case 2:rcToken=_context2.sent;startVBrowser(rcToken,{size:large?'large':'',region:large?_this2.state.regionPlus:_this2.state.region});closeModal();case 5:case\"end\":return _context2.stop();}}},_callee2);})),children:large?'Launch VBrowser+':'Continue with Free'});});var vmPoolFullMessage=/*#__PURE__*/_jsx(Message,{size:\"small\",color:\"red\",icon:\"hourglass two\",style:{width:'380px'},header:\"No Free VBrowsers Available\",content:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{children:\"All of the free VBrowsers are currently being used.\"}),/*#__PURE__*/_jsx(\"div\",{children:\"Please consider subscribing for anytime access to faster VBrowsers, or try again later.\"})]})});var options=[{key:'US',text:'US',value:'US',icon:'flag'},{key:'EU',text:'EU',value:'EU',icon:'flag'}];return/*#__PURE__*/_jsx(GoogleReCaptchaProvider,{reCaptchaKey:process.env.REACT_APP_RECAPTCHA_SITE_KEY,useRecaptchaNet:true,children:/*#__PURE__*/_jsxs(Modal,{open:true,onClose:closeModal,children:[/*#__PURE__*/_jsx(Modal.Header,{children:\"Launch a VBrowser\"}),/*#__PURE__*/_jsx(Modal.Content,{image:true,children:/*#__PURE__*/_jsxs(Modal.Description,{children:[/*#__PURE__*/_jsx(\"div\",{children:\"You're about to launch a virtual browser to share in this room.\"}),/*#__PURE__*/_jsxs(Table,{definition:true,unstackable:true,striped:true,celled:true,children:[/*#__PURE__*/_jsx(Table.Header,{children:/*#__PURE__*/_jsxs(Table.Row,{children:[/*#__PURE__*/_jsx(Table.HeaderCell,{}),/*#__PURE__*/_jsx(Table.HeaderCell,{children:\"WatchParty Free\"}),/*#__PURE__*/_jsx(Table.HeaderCell,{children:\"WatchParty Plus\"})]})}),/*#__PURE__*/_jsxs(Table.Body,{children:[/*#__PURE__*/_jsxs(Table.Row,{children:[/*#__PURE__*/_jsx(Table.Cell,{children:\"VBrowser Resolution\"}),/*#__PURE__*/_jsx(Table.Cell,{children:\"720p\"}),/*#__PURE__*/_jsx(Table.Cell,{children:\"1080p\"})]}),/*#__PURE__*/_jsxs(Table.Row,{children:[/*#__PURE__*/_jsx(Table.Cell,{children:\"VBrowser CPU/RAM\"}),/*#__PURE__*/_jsx(Table.Cell,{children:\"Standard\"}),/*#__PURE__*/_jsx(Table.Cell,{children:\"Extra\"})]}),/*#__PURE__*/_jsxs(Table.Row,{children:[/*#__PURE__*/_jsx(Table.Cell,{children:\"VBrowser Session Length\"}),/*#__PURE__*/_jsx(Table.Cell,{children:\"3 hours\"}),/*#__PURE__*/_jsx(Table.Cell,{children:\"24 hours\"})]}),this.props.beta&&/*#__PURE__*/_jsxs(Table.Row,{children:[/*#__PURE__*/_jsx(Table.Cell,{children:\"Region\"}),/*#__PURE__*/_jsx(Table.Cell,{children:/*#__PURE__*/_jsx(Dropdown,{selection:true,onChange:function onChange(e,_ref3){var value=_ref3.value;return _this2.setState({region:value});},value:this.state.region,options:options})}),/*#__PURE__*/_jsx(Table.Cell,{children:/*#__PURE__*/_jsx(Dropdown,{selection:true,onChange:function onChange(e,_ref4){var value=_ref4.value;return _this2.setState({regionPlus:value});},value:this.state.regionPlus,options:options})})]}),/*#__PURE__*/_jsxs(Table.Row,{children:[/*#__PURE__*/_jsx(Table.Cell,{}),/*#__PURE__*/_jsx(Table.Cell,{children:this.props.user?this.state.isVMPoolFull?vmPoolFullMessage:/*#__PURE__*/_jsx(LaunchButton,{}):/*#__PURE__*/_jsx(SignInButton,{fluid:true,user:this.props.user})}),/*#__PURE__*/_jsx(Table.Cell,{children:this.props.isSubscriber?/*#__PURE__*/_jsx(LaunchButton,{large:true}):this.props.subscribeButton})]})]})]})]})})]})});}}]);return VBrowserModal;}(React.Component);","map":{"version":3,"sources":["/home/runner/work/watchparty/watchparty/src/components/Modal/VBrowserModal.tsx"],"names":["React","Modal","Button","Table","Message","Dropdown","GoogleReCaptchaProvider","withGoogleReCaptcha","SignInButton","serverPath","VBrowserModal","state","isVMPoolFull","region","regionPlus","window","fetch","resp","json","metadata","HetznerUS","setState","props","closeModal","startVBrowser","LaunchButton","googleReCaptchaProps","large","undefined","executeRecaptcha","rcToken","size","vmPoolFullMessage","width","options","key","text","value","icon","process","env","REACT_APP_RECAPTCHA_SITE_KEY","beta","e","user","isSubscriber","subscribeButton","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { Modal, Button, Table, Message, Dropdown } from 'semantic-ui-react';\nimport {\n  GoogleReCaptchaProvider,\n  withGoogleReCaptcha,\n} from 'react-google-recaptcha-v3';\nimport { SignInButton } from '../TopBar/TopBar';\nimport { serverPath } from '../../utils';\nimport firebase from 'firebase/compat/app';\n\nexport class VBrowserModal extends React.Component<{\n  closeModal: Function;\n  startVBrowser: Function;\n  isSubscriber: boolean;\n  subscribeButton: JSX.Element;\n  user?: firebase.User;\n  beta?: boolean;\n}> {\n  state = { isVMPoolFull: false, region: 'US', regionPlus: 'US' };\n  async componentDidMount() {\n    const resp = await window.fetch(serverPath + '/metadata');\n    const metadata = await resp.json();\n    // TODO make this check on region change\n    if (metadata.isVMPoolFull?.HetznerUS) {\n      this.setState({ isVMPoolFull: true });\n    }\n  }\n  render() {\n    const { closeModal, startVBrowser } = this.props;\n    const LaunchButton = withGoogleReCaptcha(\n      ({ googleReCaptchaProps, large }: any) => (\n        <Button\n          size=\"large\"\n          color={large ? 'orange' : undefined}\n          onClick={async () => {\n            const rcToken = await (\n              googleReCaptchaProps as any\n            ).executeRecaptcha('launchVBrowser');\n            startVBrowser(rcToken, {\n              size: large ? 'large' : '',\n              region: large ? this.state.regionPlus : this.state.region,\n            });\n            closeModal();\n          }}\n        >\n          {large ? 'Launch VBrowser+' : 'Continue with Free'}\n        </Button>\n      )\n    );\n    const vmPoolFullMessage = (\n      <Message\n        size=\"small\"\n        color=\"red\"\n        icon=\"hourglass two\"\n        style={{ width: '380px' }}\n        header=\"No Free VBrowsers Available\"\n        content={\n          <div>\n            <div>All of the free VBrowsers are currently being used.</div>\n            <div>\n              Please consider subscribing for anytime access to faster\n              VBrowsers, or try again later.\n            </div>\n          </div>\n        }\n      />\n    );\n\n    const options = [\n      { key: 'US', text: 'US', value: 'US', icon: 'flag' },\n      { key: 'EU', text: 'EU', value: 'EU', icon: 'flag' },\n    ];\n\n    return (\n      <GoogleReCaptchaProvider\n        reCaptchaKey={process.env.REACT_APP_RECAPTCHA_SITE_KEY as string}\n        useRecaptchaNet\n      >\n        <Modal open={true} onClose={closeModal as any}>\n          <Modal.Header>Launch a VBrowser</Modal.Header>\n          <Modal.Content image>\n            <Modal.Description>\n              <div>\n                You're about to launch a virtual browser to share in this room.\n              </div>\n              <Table definition unstackable striped celled>\n                <Table.Header>\n                  <Table.Row>\n                    <Table.HeaderCell />\n                    <Table.HeaderCell>WatchParty Free</Table.HeaderCell>\n                    <Table.HeaderCell>WatchParty Plus</Table.HeaderCell>\n                  </Table.Row>\n                </Table.Header>\n\n                <Table.Body>\n                  <Table.Row>\n                    <Table.Cell>VBrowser Resolution</Table.Cell>\n                    <Table.Cell>720p</Table.Cell>\n                    <Table.Cell>1080p</Table.Cell>\n                  </Table.Row>\n                  <Table.Row>\n                    <Table.Cell>VBrowser CPU/RAM</Table.Cell>\n                    <Table.Cell>Standard</Table.Cell>\n                    <Table.Cell>Extra</Table.Cell>\n                  </Table.Row>\n                  <Table.Row>\n                    <Table.Cell>VBrowser Session Length</Table.Cell>\n                    <Table.Cell>3 hours</Table.Cell>\n                    <Table.Cell>24 hours</Table.Cell>\n                  </Table.Row>\n                  {this.props.beta && (\n                    <Table.Row>\n                      <Table.Cell>Region</Table.Cell>\n                      <Table.Cell>\n                        <Dropdown\n                          selection\n                          onChange={(e, { value }) =>\n                            this.setState({ region: value })\n                          }\n                          value={this.state.region}\n                          options={options}\n                        ></Dropdown>\n                      </Table.Cell>\n                      <Table.Cell>\n                        <Dropdown\n                          selection\n                          onChange={(e, { value }) =>\n                            this.setState({ regionPlus: value })\n                          }\n                          value={this.state.regionPlus}\n                          options={options}\n                        ></Dropdown>\n                      </Table.Cell>\n                    </Table.Row>\n                  )}\n                  <Table.Row>\n                    <Table.Cell></Table.Cell>\n                    <Table.Cell>\n                      {this.props.user ? (\n                        this.state.isVMPoolFull ? (\n                          vmPoolFullMessage\n                        ) : (\n                          <LaunchButton />\n                        )\n                      ) : (\n                        <SignInButton fluid user={this.props.user} />\n                      )}\n                    </Table.Cell>\n                    <Table.Cell>\n                      {this.props.isSubscriber ? (\n                        <LaunchButton large />\n                      ) : (\n                        this.props.subscribeButton\n                      )}\n                    </Table.Cell>\n                  </Table.Row>\n                </Table.Body>\n              </Table>\n            </Modal.Description>\n          </Modal.Content>\n        </Modal>\n      </GoogleReCaptchaProvider>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}